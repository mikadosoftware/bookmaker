<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<title>X Windows</title>
<link rel="stylesheet" href="/css/thebook.css" type="text/css" />
</head>
<body>
<div class="document" id="x-windows">
<h1 class="title">X Windows</h1>

<p>X-Windows, or X, is the Unix version of the well-known Desktop/Windows/Mouse Graphical User Interface.
First developed at Parc-Xerox (and the history of that development and how Apple and Microsoft subsequently
took the concepts to the mainstream is fascinating, and can be found at XXX), the concept of using
overlapping windows, and a 'mouse' is often seen as the <em>only</em> way to interact with a computer.</p>
<p>Of course the unix tradition is for a command line interface - that of typing in commands to a shell,
and is a more powerful way to interact in almost all cases (<a href="#id1"><span class="problematic" id="id2">*</span></a>_). X-windows is of course the wrapper
around the basic unix functionality that provides</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">thebook/XWindows.chp</tt>, line 10); <em><a href="#id2">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<p>Firstly, we are still at the command line when we boot our machine, and after logging in I still
only have the prompt. On a machine that has X installed, we can type</p>
<blockquote>
startx</blockquote>
<p>and up comes the GUI. (to get out of the GUI, use ctl-alt-backspace. This will stop the current X session)</p>
<p>So let us get X installed and running. NB. installing X from Ports takes hours, and if you compile KDE or GNOME
instead of xfce4, you can easily have it running for a full 24 hours. Honest. Try xfce4 for now.</p>
<p>(would it be nice to turn some of these links into jscript drop links that allow people to go elsewhere
(ie unix prompt) - so I introduce a disambiguation page, the jscript grabs the links and has drop list of links)
Basically view this as less a book and partially a wiki)</p>
<div class="section" id="installing">
<h1>Installing</h1>
<p>There is a meta-port for X windows. PArt of the base paul install</p>
</div>
<div class="section" id="configuring-windows">
<h1>Configuring windows</h1>
<p>See chapter 5 of Handbook</p>
<p>I am assuming we are only using one video card and one monitor.
More complex arrangements can come later.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">sidebar:</th><td class="field-body">Enabling the mouse daemon.
You should have the mouse daemon enabled in /etc/rc.conf
moused_enable=&quot;YES&quot;
Otherwise, X will try and use /dev/sysmouse and nothing much will happen whne you move the mouse</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="initial-configuation">
<h1>Initial COnfiguation.</h1>
<p>#Xorg -configure</p>
<p>THis will automatically scan your hardware and put a config file in /root called xorg.config.new</p>
<p>Try it out - you never know !</p>
<p>#Xorg -config /root/xorg.config.new</p>
<p>You will see a sawtooth background with a X cross in the middle. Try moving the mouse. If the cross moves too,
good. If not, you probably need to enable the mouse daemon. (see sidebar)</p>
<p>MOre than likely you will have a sawtooth pattern that has lines scanning through it wildly.
This is because the scan and refresh rates that X Windows is trying to use are out of whack with the ones the monitor uses.</p>
<p>DOnt forget - you can &quot;kill&quot; off the X display using ctl-alt-backspace</p>
<p>so, we find the hard part of X windows installation. FInding refresh rates. FOr some reason these are always hard to get
hold of.</p>
</div>
<div class="section" id="monitor-specs">
<h1>Monitor specs</h1>
<pre class="literal-block">
Before configuration of X11 the following information about the target system is needed:
- Monitor specifications
- Video Adapter chipset
- Video Adapter memory
</pre>
<p>some background
<a class="reference external" href="http://www.monitorworld.com/faq_pages/q10_page.html">http://www.monitorworld.com/faq_pages/q10_page.html</a>:</p>
<pre class="literal-block">
A monitor's maximum vertical refresh rate is limited by how fast it can direct the electron beam over all of the picture elements on the monitor. This involves moving the electron beam in the same manner as you would read the words in a book, left to right, top to bottom. It is limited by the maximum HSR, which determines the maximum horizontal pixel addressability the monitor can display and the number of scanlines (i.e. vertical addressability). For example, to display a screen with an addressability of 640 pixels horizontally and 480 vertically, a monitor with a HSR of 31.5kHz would take 480/31.5k = 15.2 ms to scan the entire screen once. In one second, this monitor could be refreshed 1000ms/15.2ms = 65.6 times. However, the vertical sync - movement of the electron gun to the upper left corner of the screen - requires some time, so the resulting vertical refresh rate is only 60 Hz.
</pre>
<p>A (fair) bit of googleing gets me</p>
<p>EDID Name : CAL L15CX (my monitor badge)
Minimum HorizSync : 30.000 kHz
Maximum HorizSync : 60.000 kHz
Minimum VertRefresh : 56 Hz
Maximum VertRefresh : 75 Hz
Maximum PixelClock : 80.000 MHz
Maximum Width : 1024 pixels
Maximum Height : 768 pixels
Preferred Width : 1024 pixels
Preferred Height : 768 pixels
Preferred VertRefresh : 75 Hz
Physical Width : 300 mm
Physical Height : 230 mm</p>
<p>SO I want to enter the following</p>
<p>HorizSync    30-60
VertRefresh  56-75</p>
<p>I try it - and hey presto, the sawtooth is still flickering.
So I play around a bit. Now the lines are rolling up the screen, so I guess it is the vertical refresh rate that is wrong
I constrain the refresh rates, 69-75, 74-75, and then try 70-70. Hey, google is not so useful after all the refresh rate
I found was too high. dropping it down to 70HZ gives me a clear fixed sawtooth. And the manufacturers website has broken links on it
so I fear that unless you buy top quality monitors this sort of problem is always going to be withus.</p>
<p>Please note however, that just typing startx often just works with good enough defaults. The whole thing was usable before
I played around. I just like it so.</p>
<p>HorizSync    50-60
VertRefresh  56-70</p>
<p>If I dropped the horizontal sync, the vert refresh goes out of whack.</p>
</div>
<div class="section" id="keyboard-layout">
<h1>Keyboard layout</h1>
<dl class="docutils">
<dt>Section &quot;InputDevice&quot;</dt>
<dd>Identifier  &quot;Keyboard0&quot;
Driver      &quot;kbd&quot;</dd>
</dl>
<p>We can see the various options in /usr/local/share/X11/xkb/rules/org.lst
UK is gb.
(Now actually Great Britain is not the same as United Kingdom, and this is one of those internationalisation
problems, that the real world is a lot more complicated than one poor programmer can be bothered to deal with)</p>
<p>Now this file is in the Xkb directory and if you grep for ^!
! model
! layout
! variant
! option</p>
<p>so I want:</p>
<pre class="literal-block">
Option &quot;XkbLayout&quot; &quot;gb&quot;
</pre>
<p>If I wanted to give a command about a variant it is:</p>
<pre class="literal-block">
Option &quot;XkbVariant&quot; &quot;xxxx&quot;
</pre>
</div>
<div class="section" id="turn-off-capslock">
<h1>Turn off Capslock</h1>
<p>Oh dear god yes.
Have a look in /usr/local/share/X11/xkb/rules/org.lst - do you see it. Oh wonder of wonders. A way to
turn off the capslock key, the useless appendix of the typewriter, out-evolved and just laying there waiting for an
unwary thumb to catch it an ruin a line of text.</p>
<p>under !option  I find ctrl:nocaps</p>
<p>Option &quot;XkbOptions&quot; &quot;ctrl:nocaps&quot;</p>
<p>(OK, its Options with an s. Nothing is quite perfect, just accept it for now. A little bit of handwaving.)</p>
</div>
<div class="section" id="fix-the-config-file-in-the-right-place">
<h1>Fix the config file in the right place</h1>
<p># cp xorg.conf.new /etc/X11/xorg.conf
OR
# cp xorg.conf.new /usr/local/etc/X11/xorg.conf</p>
<p>Now try startx - and horray I can type shft-2 and see &quot; and if I press capslock, it ignores it (well it treats it as
a second ctl key but who cares.)</p>
</div>
<div class="section" id="fonts">
<h1>Fonts</h1>
<div class="section" id="x11">
<h2>X11</h2>
<p>/usr/ports/x11-fonts/ttmkfdir</p>
<p>fonts
C:WINDOWSFonts
http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/x-fonts.html
pscp <a href="#id3"><span class="problematic" id="id4">*</span></a>.ttf <a class="reference external" href="mailto:root&#64;192.168.1.11">root&#64;192.168.1.11</a>:/usr/local/lib/X11/fonts/TrueType/
add line to xorg.conf
FontPath &quot;/usr/X11R6/lib/X11/fonts/URW&quot;
type 1 fonts make</p>
<div class="system-message" id="id3">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">thebook/XWindows.chp</tt>, line 199); <em><a href="#id4">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</div>
</div>
<div class="section" id="xdm">
<h1>XDM</h1>
<p>For testing purposes, we just want the XDM to run as a normal process not a daemon.
so we call it as</p>
<pre class="literal-block">
#xdm -nodaemon
</pre>
<p>(if you get stuck, simply ctl-alt-f1 to tty and kill the daemon xdm. You should understand how to do that by now)</p>
<p>now, normally</p>
<pre class="literal-block">
% echo &quot;/usr/local/bin/startxfce4&quot; &gt; ~/.xinitrc
</pre>
<p>will ensure that when I type 'startx' xfce will run.
However if I use xdm, it does not use my .xinitrc file.</p>
<p>xdm uses files found in ' usr/local/lib/X11/xdm' for configuration.
SO I can use a ~/.xsession or the global xsession file</p>
<p>% echo &quot;/usr/local/bin/startxfce4&quot; &gt; ~/.xsession</p>
<p>so
1. .xinitrc file with startxfce4 works only with startx, not with xdm
2. .xsession file with startxfce4 works with xdm</p>
</div>
<div class="section" id="now-how-to-run-xdm-every-boot">
<h1>Now how to run xdm every boot</h1>
<p>can be set as a tty - in /etc/ttys this line is off by default.:</p>
<pre class="literal-block">
ttyv8   &quot;/usr/local/bin/xdm -nodaemon&quot;  xterm   off secure
</pre>
<p>setting it to on will ensure each boot gets you a graphical login.</p>
<p><a class="reference external" href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/x11-wm.html">http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/x11-wm.html</a>
# cd /usr/ports/x11-wm/xfce4
# make install clean</p>
</div>
<div class="section" id="swapping-between-vitrual-terminals">
<h1>Swapping between vitrual terminals</h1>
<p>X runs on a virtual terminal (alt-F1 alt-F2 etc)
If in X you can go to the other tty using ctl-alt-F1 for example.
Then get back using alt-F9 (usually there are 8 tty set up in /etc/ttys - so X snaffles the 9th)</p>
</div>
<div class="section" id="splash-screens-and-xmodmap">
<h1>SPlash screens and xmodmap</h1>
<p><a class="reference external" href="http://www.freebsd.org/doc/en/books/faq/x.html#XDM-BOOT">http://www.freebsd.org/doc/en/books/faq/x.html#XDM-BOOT</a></p>
<div class="section" id="more-than-one-card-monitor">
<h2>More than one card / monitor</h2>
<p>Cards are 'Device' in the config file - you can tell which is labelled which by looking at the Device secion(s)
It will tell you the Identifier (Card0) and which driver is being used (nv for nvidia) the board name and PCI ids
Really all you want to know is the identifiers</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="phone-line">
<h1>Phone Line</h1>
<p>Phone Line - ADSL Filter - DSL Modem - Ethernet Out - Own FIrewall/router - WIFI?</p>
<p><a class="reference external" href="http://www.broadbandbuyer.co.uk/Shop/ShopDetail.asp?ProductID=4122">http://www.broadbandbuyer.co.uk/Shop/ShopDetail.asp?ProductID=4122</a></p>
<div class="section" id="dns">
<h2>DNS</h2>
<p>BIND8 is installed by default
named_enable=&quot;YES&quot;</p>
</div>
<div class="section" id="ntp">
<h2>NTP</h2>
</div>
<div class="section" id="ftp">
<h2>FTP</h2>
</div>
<div class="section" id="nfs">
<h2>NFS</h2>
<p><a href="#id5"><span class="problematic" id="id6">*</span></a>_ THe only time I can see gui-style interaction as more powerful is in photo-editing and similar efforts.</p>
<div class="system-message" id="id5">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">thebook/XWindows.chp</tt>, line 303); <em><a href="#id6">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</div>
</div>
</div>
</body>
</html>
